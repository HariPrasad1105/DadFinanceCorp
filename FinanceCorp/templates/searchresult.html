{% extends 'header.html' %}


{% block contents %}
    <script>
        function show1(){
            document.getElementById('tbody1').style.display = "block";
            document.getElementById('tbody2').style.display = "none";
        }
    </script>
    <body onload="show1()">
    <style>
        .tableclass{
            position: relative;
            top: 50%;
        }

        table a:link {
            color: #666;
            font-weight: bold;
            text-decoration:none;
        }

        table a:visited {
            color: #999999;
            font-weight:bold;
            text-decoration:none;
        }

        table a:active,
        table a:hover {
            color: #bd5a35;
            text-decoration:underline;
        }

        table {
            font-family:Arial, Helvetica, sans-serif;
            color:#666;
            font-size:15.5px;
            text-shadow: 1px 1px 0px #fff;
            background:#eaebec;
            margin:20px;
            border:#ccc 1px solid;

            -moz-border-radius:3px;
            -webkit-border-radius:3px;
            border-radius:3px;

            -moz-box-shadow: 0 1px 2px #d1d1d1;
            -webkit-box-shadow: 0 1px 2px #d1d1d1;
            box-shadow: 0 1px 2px #d1d1d1;
        }

        table th {
            padding:21px 25px 22px 25px;
            border-top:1px solid #fafafa;
            border-bottom:1px solid #e0e0e0;

            background: #ededed;
            background: -webkit-gradient(linear, left top, left bottom, from(#ededed), to(#ebebeb));
            background: -moz-linear-gradient(top,  #ededed,  #ebebeb);
        }

        table th:first-child {
            text-align: left;
            padding-left:20px;
        }

        table tr:first-child th:first-child {
            -moz-border-radius-topleft:3px;
            -webkit-border-top-left-radius:3px;
            border-top-left-radius:3px;
        }

        table tr:first-child th:last-child {
            -moz-border-radius-topright:3px;
            -webkit-border-top-right-radius:3px;
            border-top-right-radius:3px;
        }

        table tr {
            text-align: center;
            padding-left:20px;
        }

        table td:first-child {
            text-align: left;
            padding-left:20px;
            border-left: 0;
        }

        table td {
            padding:18px;
            border-top: 1px solid #ffffff;
            border-bottom:1px solid #e0e0e0;
            border-left: 1px solid #e0e0e0;

            background: #fafafa;
            background: -webkit-gradient(linear, left top, left bottom, from(#fbfbfb), to(#fafafa));
            background: -moz-linear-gradient(top,  #fbfbfb,  #fafafa);
        }

        table tr.even td {
            background: #f6f6f6;
            background: -webkit-gradient(linear, left top, left bottom, from(#f8f8f8), to(#f6f6f6));
            background: -moz-linear-gradient(top,  #f8f8f8,  #f6f6f6);
        }

        table tr:last-child td {
            border-bottom:0;
        }

        table tr:last-child td:first-child {
            -moz-border-radius-bottomleft:3px;
            -webkit-border-bottom-left-radius:3px;
            border-bottom-left-radius:3px;
        }

        table tr:last-child td:last-child {
            -moz-border-radius-bottomright:3px;
            -webkit-border-bottom-right-radius:3px;
            border-bottom-right-radius:3px;
        }

        table tr:hover td {
            background: #f2f2f2;
            background: -webkit-gradient(linear, left top, left bottom, from(#f2f2f2), to(#f0f0f0));
            background: -moz-linear-gradient(top,  #f2f2f2,  #f0f0f0);
        }
       .add-on .input-group-btn > .btn {
          border-left-width:0;left:-2px;
          -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
          box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
        }

       /* stop the glowing blue shadow */
        .add-on .form-control:focus {
         box-shadow:none;
         -webkit-box-shadow:none;
         border-color:#cccccc;
        }

       .form-control{width:20%}

       .navbar-nav > li > a {
          border-right: 1px solid #ddd;
          padding-bottom: 15px;
          padding-top: 15px;
        }

        .navbar-nav:last-child{ border-right:0}

        .tbody2{
            display: none;
        }

    </style>
    <script>
        function addCommas(input)
        {
            var string1 = input.toString();
            if(string1.length <= 3)
            {
                return string1;
            }
            else
            {
                var count = 0, result = '';
                for (var i = string1.length-1; i >= 0; i--)
                {
                    count = count + 1;
                    if (count > 1 && (count % 2 == 1))
                    {
                        result = ',' + string1.charAt(i) + result;
                    }
                    else
                    {
                        result = string1.charAt(i) + result;
                    }
                }
                if (result[0] == ',') {
                    return result.substring(1)
                }
                return result;
            }
        }
        function show()
        {
            var x = document.getElementById('tbody1');
            var y = document.getElementById('tbody2');
            if(x)
            {
                if(x.style.display == "none")
                {
                    x.style.display = "block";
                    y.style.display = "none"
                }
                else
                {
                    x.style.display = "none";
                    y.style.display = "block;"
                }
            }
        }
        function alertFunction(){
                var msg = confirm("Are you sure, you want to delete?");
                if(msg == true){
                    return true;
                }
                else{
                    return false;
                }
        }
    </script>
    <div class="container" align="center"><br><br><br><br>
        <form class="navbar-form" method="get" role="search" action="search/" style="padding-top:0%;">
            <div class="input-group" align="center">
                <input type="text" placeholder="Search Lender/Payee" name="q" value="{{ request.GET.q }}" style="width: 665px; height: 38px; font-size: 18px; font-family: 'Baskerville Old Face'; padding-left: 15px; border-style: groove;">
                <div class="input-group-btn">
                    <button class="btn btn-danger" type="submit" style="height: 38px;"><i class="glyphicon glyphicon-search"></i></button>
                </div>
            </div>
        </form>
    </div>
    <p align="center" style="font-size: 25px; padding-top: 4%">Search Results</p>
    <div class="tablecontainer-1" align="center">
        <div class="tablecontainer-2" style="padding-top: 2%">
            <table class="tableclass" width="1100px" border="1">
                <thead>
                    <tr style="padding-left: 15%">
                        <th style="width: 17%; padding-left: 7%;">Name</th>
                        <th style="width: 12%; padding-left: 3%;">Amount</th>
                        <th style="width: 17%">Interest Amount</th>
                        <th style="width: 15%;">Due Date</th>
                        <th style="width: 12%">Category</th>
                        <th width="250px"></th>
                    </tr>
                </thead>
                <tbody style="background-color:red;">
                    {% if msg != 'returned' %}
                        <div id="tbody1" style="display: none;">
                            {% if not items %}
                                <p style="font-size: 25px; color: red">Empty Search Result</p>
                            {% else %}
                                {% for i in items %}
                                    <tr>
                                        <th style="padding-left: 30px">{{ i.firstname }}</th>
                                        <th><script>document.write(addCommas({{ i.amount }}));</script></th>
                                        <th style="padding-left: 5%">{{ i.interest }}%</th>
                                        <th>{{ i.duedate }}</th>
                                        {% if not i.period %}
                                            <th>Lender</th>
                                        {% else %}
                                            <th>Payee</th>
                                        {% endif %}
                                        <th width="250px">
                                            <a href="addpayment{{ i.type }}{{ i.id }}/"><button class="btn btn-danger">Add Payment</button></a>
                                            <a href="update{{ i.id }}-{{ i.type }}"><button class="btn btn-danger" style="margin-left: 10%; width: 80px; font-size: 17px">update</button></a>
                                            <a href="{{ i.id }}{{ i.type }}delete"><button class="btn btn-danger" onclick="alertFunction();" style="margin-left: 20%; width: 80px; font-size: 17px">delete</button></a>
                                        </th>
                                    </tr>
                                {% endfor %}
                            {% endif %}
                        </div>
                    {% else %}
                        <div class="tbody2" id="tbody2">
                            {% for i in object %}
                                <tr>
                                    <form method="post" action="updatesave{{ i.type }}-/">{% csrf_token %}
                                        <input type="hidden" name="id" value="{{ i.pk }}">
                                        <th style="padding-left: 30px">{{ i.firstname }}</th>
                                        <th><input type="text" id="amount" name="amount" style="width: 150px"></th>
                                        <th><input type="text" id="interest" name="interest" style="width: 150px"></th>
                                        <th>{{ i.duedate }}</th>
                                        {% if not i.period %}
                                            <th>Lender</th>
                                        {% else %}
                                            <th>Payee</th>
                                        {% endif %}
                                        <th>
                                            <a style="padding-left: px"><button class="btn btn-danger" onclick="">update</button></a>
                                            <button class="btn btn-danger" style="" onclick="alertFunction({{ i.pk }}, {{ i.type }});">delete</button>
                                        </th>
                                    </form>

                                </tr>
                            {% endfor %}
                        </div>
                    {% endif %}
                </tbody>
            </table>
        </div>
    </div>

</body>
{% endblock %}